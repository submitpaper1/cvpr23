# PyTorch Implementation of Iterated Integrated Gradients


<p align="center">
  <img width="260" height="350" src="iig_sample.png">
</p>

## Introduction
Official Pytorch implementation of Iterated Integrated Gradients (IIG).

We introduce a novel method which allows to visualize classifications made by CNN models for vision tasks.
Our method also allows to visualize explanations per class.

On this method we use present the idea of iterated integrated gradients.

## Producing IIG Classification Saliency Maps
Images should be on `data\ILSVRC2012_img_val` directory.
The text file on `data\pics.txt` includes text lines indicating the images being evaluated and the target class they are being evaluated with. The lines are of the following format: `<file_name> target_class_number` (For example: `ILSVRC2012_val_00002214.JPEG 153`).
To produce saliency maps of our method, run the following command:
```
python saliency_map_generator.py
```
The default network which maps are generated by is Resnet101 on the last layer.
You can modify the chosen network and layer by changing the `model_name` and `FEATURE_LAYER_NUMBER` variable on the  `saliency_map_generator.py` class.

The output saliency maps are on `qualitive_results` directory.

## Reproducing Segmentation Results

Download VOC and COCO Datasets to the data/VOC and data/COCO and run `python segmentation_coco.py`.
To run imagenet segmentation use the following dataset ([Link to download dataset](http://calvin-vision.net/bigstuff/proj-imagenet/data/gtsegs_ijcv.mat)).
```
python segmentation_imagenet.py
```

## Credits
For comparison methods code we used the following git repositories implementations:
- https://github.com/jacobgil/pytorch-grad-cam
- https://github.com/pytorch/captum
